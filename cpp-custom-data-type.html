<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=1">
<meta name="renderer" content="webkit">
<meta name="google" value="notranslate">
<meta name="robots" content="index,follow">


<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feily Zhang">
<meta name="twitter:description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta name="twitter:image:src" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">

<meta property="og:url" content="https://feily.tech">
<meta property="og:title" content="Feily Zhang">
<meta property="og:description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta property="og:site_name" content="Feily Zhang">
<meta property="og:image" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">
<meta property="og:type" content="website">
<meta name="robots" content="noodp">

<meta itemprop="name" content="Feily Zhang">
<meta itemprop="description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta itemprop="image" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">

<link rel="canonical" href="https://feily.tech">

<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-itouch-icon" href="/favicon.png">
<link rel="stylesheet" href="/bundle/index.css">
<script type="text/javascript">
    var timeSinceLang = {
        year: '年前',
        month: '个月前',
        day: '天前',
        hour: '小时前',
        minute: '分钟前',
        second: '秒前'
    };
    var root = '';
</script>

<script type="text/javascript">
    var conn, reloadTimer, connectTimer;
    var connect = function() {
        conn = new WebSocket('ws://' + location.host + '/live');
        conn.onmessage = function(event) {
            if (event.data === 'change') {
                if (reloadTimer) clearTimeout(reloadTimer);
                reloadTimer = setTimeout(function() {
                    window.location.reload();
                }, 200);
            }
        };
        conn.onclose = function() {
            if (connectTimer) clearTimeout(connectTimer);
            connectTimer = setTimeout(function() {
                connect();
            }, 1000);
        };
    };
    connect();
</script>


        <meta name="keywords" content="C&#43;&#43;,">
        <meta name="description" content="C&#43;&#43;自定义数据类型">
        <meta name="author" content="林奕清">
        <title>C&#43;&#43;自定义数据类型</title>
    </head>
    <body>
        <article class="container">
            <header class="header-wrap" style="font-family:NSimSun">
  <a class="index" href="/">
    <img class="logo" src="https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png" />
    Feily Zhang
  </a>
  <ul class="menu">
      <li class="menu-item"><a href="/archive.html">归档</a></li>
      <li class="menu-item"><a href="/about.me.html">关于</a></li>
      <li class="menu-item"><a href="/atom.xml">订阅</a></li>
  </ul>
</header>

            <article class="main article">
                <h1 class="title" style="font-family:KaiTi">C&#43;&#43;自定义数据类型</h1>
                <section class="info" style="font-family:KaiTi">
                    <span class="avatar" style="background-image: url(https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png);"></span>
                    <a class="name" href="/about.me.html">林奕清</a>
                    
                    <span class="date" data-time="1565353782"><span class="from"></span></span>
                    
                    <span class="tags">C&#43;&#43;</span>
                </section>
                <article class="content" style="font-family:KaiTi"><h2>一、数组</h2>

<p>C++数组的定义必须指明数组长度，通用格式如下</p>

<pre><code>typeName arrayName[arraySize];
</code></pre>

<p>一维数组与二维数组的示例如下：</p>

<pre><code>#include &lt;iostream&gt;

int main() {
    int arr[5];
    int arr_length = sizeof arr / sizeof arr[0];
    for (int i = 0; i &lt; arr_length; i++) {
        arr[i] = i * i;
    }
    int index = 0;
    int* pArr = arr;
    while (index != arr_length) {
        std::cout &lt;&lt; *(pArr + index) &lt;&lt; &quot;\t&quot;;
        ++index;
    }
    int arrt[5][4];
    int arr_row_len = sizeof arrt / sizeof arrt[0];
    int arr_col_len = sizeof arrt[0] / sizeof arrt[0][0];
    for (int i = 0; i &lt; arr_row_len; i++) {
        for (int j = 0; j &lt; arr_col_len; j++) {
            arrt[i][j] = i * j;
        }
    }
    std::cout &lt;&lt; std::endl;
    int(*pArrt)[4];
    pArrt = arrt;
    int row_index = 0, col_index = 0;
    for (int i = 0; i &lt; arr_row_len; i++) {
        for (int j = 0; j &lt; arr_col_len; j++) {
            std::cout &lt;&lt; *(*(pArrt + i) + j) &lt;&lt; &quot;\t&quot;;
        }
        std::cout &lt;&lt; std::endl;
    }
    std::cin.get();
    return 0;
}
</code></pre>

<p>输出为</p>

<pre><code>0       1       4       9       16
0       0       0       0
0       1       2       3
0       2       4       6
0       3       6       9
0       4       8       12
</code></pre>

<p>上述程序分别演示了一维数组和二维数组，并且数组的输入是采用常规的方式，数组的输出是采用指针的方式。</p>

<p>一维数组的指针使用符合上文中的两个等式，如下</p>

<pre><code>arr[i] = *(ar + i);
&amp;arr[i] = ar + i; 
</code></pre>

<p><strong>而二维数组的指针则相对麻烦一点，解释如下</strong></p>

<p>一维数组中声明指针的方式如下</p>

<pre><code>int* pArr = arr;
</code></pre>

<p>此时指针pArr中存储的是数组的首元素的地址，通过指针对元素的访问是加上元素偏移实现的，而指针的长度则可以防止访问越界。二维数组的指针我们换个方式看一下</p>

<p>仍然是基于上述程序，我们尝试输出一下pArrt</p>

<pre><code>std::cout &lt;&lt; pArrt;    // 0034FC2C
</code></pre>

<p>是一个地址，这很容易理解，毕竟指针存的就是地址，那么<code>*pArrt</code>以及<code>*(pArrt + 1)</code>呢，按照常理，如果pArrt是地址，那么pArrt + 1就是pArrt指针指向内存区的下一个内存区的地址，对二者取值必然是两个连续地址空间的值了，但是真的是这样吗？</p>

<pre><code>std::cout &lt;&lt; *pArrt &lt;&lt; &quot;\t&quot; &lt;&lt; *(pArrt + 1);    // 004BFB20        004BFB30
</code></pre>

<p>还是一个地址，但是观察一下这两个地址值相差16个字节，在本机int型实现为4个字节，那么按理来说每个int型元素只会占用4个字节，也就是<code>*(pArrt + 1)</code>应该是004BFB24，但是为什么是004BFB30呢？中间的12个字节去哪了？</p>

<p>不要忘了，我们二维数组的每列有4个int型元素，刚好16个字节，这样推论的话，就意味着<code>*pArrt</code>应该指的是二维数组第0行的首元素的地址，而<code>*(pArrt + 1)</code>指的就是二维数组第1行首元素的地址，因为中间12个字节刚好的第0行剩余三个元素的内存空间。那么相应的第i行的首元素的地址就是<code>*(pArrt + i)</code>。那么我们试一下第0行的值是否与上文程序输出一致</p>

<pre><code>std::cout &lt;&lt; *(*pArrt + 0) &lt;&lt; &quot;\t&quot; &lt;&lt; *(*pArrt + 1) &lt;&lt; &quot;\t&quot; &lt;&lt; *(*pArrt + 2) &lt;&lt; &quot;\t&quot; &lt;&lt; *(*pArrt + 3) &lt;&lt; &quot;\t&quot;;    // 0       0       0       0
</code></pre>

<p>完全一致！</p>

<p>那么我们再验证一下第0行的第四个元素的最后一个元素是否是第1行的首元素，如下</p>

<pre><code>std::cout &lt;&lt; *(pArrt + 0) &lt;&lt; &quot;\t&quot; &lt;&lt; *(pArrt + 1) &lt;&lt; std::endl;
for (int i = 0; i &lt; 5; i++) {
    std::cout &lt;&lt; *(pArrt + 0) + i &lt;&lt; &quot;\t&quot;;
}
</code></pre>

<p>输出为</p>

<pre><code>002EF700        002EF710
002EF700        002EF704        002EF708        002EF70C        002EF710
</code></pre>

<blockquote>
<p>注意：由于每次运行都会产生不一样的结果，所以地址是有变化的。</p>
</blockquote>

<p>观察一下输出结果的第一行和第二行的最后的地址，一模一样，这也就证明了<code>*(pArrt + 0)</code>(也就是<code>*(pArrt)</code>)存放的是第0行的首元素的地址，之后跟随的是第0行的剩余的三个元素，由于数组存储在连续地址空间，那么第1行的第一个元素必然紧接着第0行的最后一个元素，在上述代码中，也得到了证明。那么这里都得到了每个元素的地址，在取值一次不就得到了值了嘛！，对的</p>

<pre><code>for (int i = 0; i &lt; 5; i++) {
    std::cout &lt;&lt; *(*(pArrt + 0) + i) &lt;&lt; &quot;\t&quot;;
}
</code></pre>

<p>输出为</p>

<pre><code>0       0       0       0       0
</code></pre>

<p>没问题，综上，我们得出以下结论</p>

<ul>
<li><code>*(pArrt + i)</code>代表的是二维数组第i行的首元素的<strong>地址（注意，这里是地址，不是值）</strong></li>
<li><code>*(pArrt + i) + j</code>代表的就是二维数组第i行第j列的<strong>地址（注意，这里是地址，不是值）</strong></li>
<li><code>*(*(pArrt + i) + j)</code>代表的就是二维数组第i行第j列的<strong>值（现在是值了，因为通过<code>*</code>再取值了一次）</strong></li>
</ul>

<p>那么pArrt自然代表的就是<code>*pArrt</code>的地址，也就是地址的地址，即二维数组首行首元素的地址。</p>

<p><strong>还有，二维数组的指针这样声明</strong></p>

<pre><code>int(*pArrt)[4];
</code></pre>

<p>为什么？不能是<code>int * ar2[4]</code>吗？</p>

<p>不行，因为<code>int * ar2[4]</code>代表的是组织了4个int型指针的数组，其本质是int型指针，而不是数组，数组只是将其组织了起来而已。而<code>int(*pArrt)[4]</code>则代表的是二维数组的一行，这一行由4个int型元素组成，其本质是数组，指针是指向该一维数组（就是二维数组的行）的首元素地址，即指向由4个int组成的数组的指针。</p>
</article>
                <section class="author" style="font-family:NSimSun">
                    <div class="avatar" style="background-image: url(https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png);"></div>
                    <a class="name" href="/about.me.html">林奕清</a>
                    <div class="intro" style="font-family:KaiTi">If not now, when? If not me, who?</div>
                </section>
                <section class="recommend" style="font-family:KaiTi">
                    
                    
                    <section class="nav next">
                        <div class="head">下篇文章</div>
                        <a class="link" href="/predefined-data-types-in-cpp.html">C&#43;&#43;中的预定义数据类型</a>
                    </section>
                    
                </section>
                
            </article>
        </article>
        <footer class="footer" style="font-family:NSimSun">
    <span class="copyright">
        Feily Zhang ©
        <script type="text/javascript">
            document.write(new Date().getFullYear());
        </script>
    </span>
    <span class="publish">Powered by <a href="http://www.chole.io/" target="_blank">Ink</a></span>
</footer>

        <script src="/bundle/index.js"></script>
    </body>
</html>
