<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1, minimum-scale=1, maximum-scale=1">
<meta name="renderer" content="webkit">
<meta name="google" value="notranslate">
<meta name="robots" content="index,follow">


<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Feily Zhang">
<meta name="twitter:description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta name="twitter:image:src" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">

<meta property="og:url" content="https://feily.tech">
<meta property="og:title" content="Feily Zhang">
<meta property="og:description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta property="og:site_name" content="Feily Zhang">
<meta property="og:image" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">
<meta property="og:type" content="website">
<meta name="robots" content="noodp">

<meta itemprop="name" content="Feily Zhang">
<meta itemprop="description" content="昨夜星辰昨夜风，画楼西畔桂堂东">
<meta itemprop="image" content="https://feily.techhttps://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png">

<link rel="canonical" href="https://feily.tech">

<link rel="shortcut icon" href="/favicon.png">
<link rel="apple-itouch-icon" href="/favicon.png">
<link rel="stylesheet" href="/bundle/index.css">
<script type="text/javascript">
    var timeSinceLang = {
        year: '年前',
        month: '个月前',
        day: '天前',
        hour: '小时前',
        minute: '分钟前',
        second: '秒前'
    };
    var root = '';
</script>


        <meta name="keywords" content="OS,">
        <meta name="description" content="计算机操作系统原理总结">
        <meta name="author" content="林奕清">
        <title>计算机操作系统原理总结</title>
    </head>
    <body>
        <article class="container">
            <header class="header-wrap" style="font-family:NSimSun">
  <a class="index" href="/">
    <img class="logo" src="https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png" />
    Feily Zhang
  </a>
  <ul class="menu">
      <li class="menu-item"><a href="/archive.html">归档</a></li>
      <li class="menu-item"><a href="/about.me.html">关于</a></li>
      <li class="menu-item"><a href="/atom.xml">订阅</a></li>
  </ul>
</header>

            <article class="main article">
                <h1 class="title" style="font-family:KaiTi">计算机操作系统原理总结</h1>
                <section class="info" style="font-family:KaiTi">
                    <span class="avatar" style="background-image: url(https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png);"></span>
                    <a class="name" href="/about.me.html">林奕清</a>
                    
                    <span class="date" data-time="1562158694"><span class="from"></span></span>
                    
                    <span class="tags">OS</span>
                </section>
                <article class="content" style="font-family:KaiTi"><h2>一、进程的定义、特征、模型</h2>

<h4>1.1 进程的概念</h4>

<p>进程是一个可并发执行的、具有独立功能的程序关于某个数据集合的一次执行过程，也是操作系统进行资源分配与保护的基本单位。</p>

<h4>1.2 进程的属性：</h4>

<ul>
<li>结构性：进程包含了数据集合和运行于其上的程序，每个进程至少包含三个组成要素：数据块、程序块、进程控制块（PCB）；</li>
<li>共享性：同一程序运行于不同数据集合上构成不同的进程；</li>
<li>动态性：进程由创建而产生、被调度而执行、被撤销而消亡；</li>
<li>独立性：进程是操作系统中资源分配与保护的基本单位，也是系统调度的独立单位；</li>
<li>制约性：并发进程之间存在着制约关系，进程在执行的关键点上需要相互等待、互通消息；</li>
<li>并发性：在单处理器环境下，各个进程轮流占用处理器。</li>
</ul>

<h4>1.3 进程的三态模型：</h4>

<p><img src="data:image/gif;base64,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" data-src="/images/article/jinchengsantai.jpg" alt="进程三态模型" /></p>

<ul>
<li>就绪态：进程具备运行条件，等待系统分配处理器以便运行；</li>
<li>运行态：进程占用处理器正在运行；</li>
<li>阻塞态：进程不具备运行条件,正在等待某个事件完成。</li>
</ul>

<h4>1.4 进程的五态模型：</h4>

<p>在进程三态模型的基础上，引入新建态与终止态：</p>

<p><img src="data:image/gif;base64,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" data-src="/images/article/jinchengwutai.jpg" alt="进程五态模型" /></p>

<ul>
<li>新建态：创建一个进程，正在等待操作系统完成创建进程的必要操作；</li>
<li>终止态：进程已经终止，不再参与处理器竞争。</li>
</ul>

<h2>二、进程控制块（PCB）的作用、信息及组织方式</h2>

<h4>2.1 PCB的作用</h4>

<p>操作系统依靠PCB感知进程的存在，PCB是进程存在的唯一标志；</p>

<h4>2.2 PCB的信息</h4>

<ul>
<li>描述信息：进程标识符、用户名或用户标识符、家族关系；</li>
<li>控制信息：当前状态、优先级、程序开始地址、各种计时信息、通信信息；</li>
<li>资源管理信息；</li>
<li>CPU现场保护机构。</li>
</ul>

<h4>2.3 组织方式</h4>

<ul>
<li>链接队列方式：就绪、运行、阻塞队列，排队原则与调度策略有关；</li>
<li>索引表方式：就绪、运行、阻塞索引表。</li>
</ul>

<h2>三、进程的控制</h2>

<p>进程的控制是典型的事件驱动，即进程的创建、撤销及阻塞或被唤醒是由特定事件触发的。</p>

<h2>四、进程对临界资源访问的互斥性与进程间的同步</h2>

<h4>4.1 临界资源的定义</h4>

<p>并发进程可以共享进程中的各种资源，但是系统中某些资源具有一次仅允许一个进程使用的特点，这样的资源被称为临界资源。</p>

<h4>4.2 临界资源的访问</h4>

<p>对于系统中的临界资源，应保证进程的互斥访问，方法就是进行进程间的同步，同步应该遵循以下原则：独立平等、空闲让进、互斥进入、让权等待、有限等待。</p>

<h4>4.3 进程间同步的三种方法</h4>

<ul>
<li>加锁/开锁原语；</li>
<li>信号量与P、V原语</li>
<li>管程</li>
</ul>

<p>在操作系统中利用信号量来表征一种资源或状态，通过对信号量值的改变来表征进程对资源的使用状况，或判断信号量的值来控制进程的状态。<strong>信号量按取值分为以下两种</strong>：</p>

<ul>
<li>二元信号量：仅允许取值为0或1，主要用于解决<strong><em>进程互斥</em></strong>问题；</li>
<li>一般信号量：初值常常为可用资源数，可以大于1，多用来进行<strong><em>进程同步</em></strong>。</li>
</ul>

<p>对<strong>信号量S定义</strong>如下：</p>

<ol>
<li>S是一个整型变量且初值非负；</li>
<li>对信号量仅能实施P(S)、V(S)操作，也只有这两种操作才能改变S的值；</li>
<li>每个信号量都对应一个等待队列，队列中的进程处于等待状态。</li>
</ol>

<p><strong>P原语的操作定义</strong>如下：</p>

<ol>
<li>S减一；</li>
<li>若S减一后仍大于等于零，则进程继续执行；</li>
<li>若S减一后小于零，则该进程被阻塞进入该信号的等待队列中，然后转进程调度。</li>
</ol>

<p><strong>V原语的操作定义</strong>如下：</p>

<ol>
<li>S加1；</li>
<li>若S加一后结果大于零，则进程继续执行；</li>
<li>若S加一后结果小于等于零，则从该信号量的等待队列中唤醒一个等待进程，然后再返回原进程继续执行或转进程调度。</li>
</ol>

<p><strong><u>综上，对信号量以及P、V操作的伪代码描述如下：</u></strong></p>

<pre><code>typedef struct semaphore {
    int value;    // 信号量值
    struct pcb *list;    // 信号量队列指针
} semaphore;

void P(semaphore &amp;s) {
    s.value--;    // 执行一次P操作，代表索取一个资源，代表资源的信号量值减一
    if (s.value &lt; 0 ) W(s.list);    // 如果value值减一后小于0那么说明暂时没有该类资源可供使用，该进程进入阻塞队列
}

void V(semaphore &amp;s) {
    s.value++;    // 执行一次V操作，代表释放一个资源，信号量value值加一
    if (s.value &lt;= 0) R(s.list);       // 如果value值&lt;=0，那么说明有进程因无法获取资源而阻塞，所以去阻塞队列唤醒一个
}
</code></pre>

<p>需要注意的是<strong>P、V操作具有严格的不可分割性</strong>，有两层含义：</p>

<ul>
<li>信号量是系统中的公共变量，对某一信号量的操作必须是互斥的；</li>
<li>P、V操作是一对操作，若有对信号量S的P操作，那么必须也有对信号量S的V操作，反之亦然。</li>
</ul>

<p>那么，<strong><u>利用信号量实现互斥的方法</u></strong>为：为临界区资源设一个信号量<code>mutex</code>，初值为<code>1</code>，将临界区置于<code>P(mutex)</code>和<code>V(mutex)</code>之间，<code>P(mutex)</code>和<code>V(mutex)</code>一定要成对出现在同一个进程中。伪代码描述为</p>

<pre><code>semaphore mutex;
mutex = 1;
cobegin
process Pi() {
    P(mutex);
    {对临界区的具体操作};
    V(mutex);
}
coend
</code></pre>

<p>以上互斥为二元信号量，可以看出等同于显式锁的加锁与释放，即某进程在对共享变量进行操作时，需要执行P操作(等同于加锁)，操作完毕时需要执行V操作(等同于释放锁)。那么对于<strong><u>代表可用资源数目的一般信号量应该如何描述</u></strong>呢？</p>

<p>代表可用资源数目的一般信号量的P、V操作一般分散在各个进程中，以生产者-消费者为例，生产者每执行一次生产操作，对于代表缓冲区商品数目个数的信号量full来说就需要执行一次V操作，代表生产的可用资源数目加一，相对应地，对于代表商品缓冲区空缓冲区的个数的信号量empty来说，就需要执行一次P操作，含义为每生产一次空缓冲区数目减一。相对应的，消费者进程则是对full信号量执行P操作代表消费一次缓冲区数目减少一个，empty信号量执行V操作，代表消费一次，缓冲区空闲多一个。</p>

<p><strong><p style="color:red">总而言之，多进程环境下对于临界区的操作必须使用互斥信号量进行同步（参见伪代码描述），而对于代表可用资源数目的一般信号量，则由多进程相互配合完成。</p></strong></p>

<p><strong><u>拓展阅读：</u></strong><p style="border:1px dotted black"><strong>P、V操作的物理意义</strong>：在共享同一类资源的具有相互合作关系的进程之间，信号量的初值用来表示系统中同类资源的可用数目。因此当信号量S等于0时，表示没有空闲的该类资源可用；S &lt; 0时，其绝对值表示因请求该类资源而被阻塞的进程数，每执行一次P操作意味着请求分配一个单位的某类资源，因此描述为S = S - 1；若S &lt; 0表示已无该类资源可供分配，因此把该进程加入到与S相关的等待队列中。进程使用完某类资源后必须执行一次V操作，意味着释放一个单位的该类资源，因此描述为S = S + 1；若S &lt;= 0表示已有进程在等待该类资源，因此唤醒等待队列中的第一个或优先级最高的进程，允许其使用该类资源。</p></p>

<h2>五、利用信号量实现同步示例</h2>

<h4>5.1 哲学家进餐问题</h4>

<p>问题描述：有5个哲学家围坐在一张圆桌旁，桌面中央有一盘通心面，每个人面前有一只空盘子，每两个人之间放一把叉子。每个哲学家思考、饥饿、吃面。为了吃面，每个哲学家必须获得两把叉子，且每人只能从自己左边或右边取叉子，如图所示</p>

<p><img src="data:image/gif;base64,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" data-src="/images/article/zhexuejiajincan.jpg" alt="哲学家进餐及引起思索" /></p>

<p>解决方案：</p>

<ol>
<li>至多允许4位哲学家同时去拿左边的叉子，保证至少有一位哲学家能够进餐；</li>
<li>规定奇数号哲学家先拿其左边的叉子，再拿其右边的叉子；偶数号哲学家先拿其右边的叉子，再拿其左边的叉子；</li>
<li>仅当哲学家的左右两把叉子均可使用时，才允许他进餐，否则一把叉子也不取。</li>
</ol>

<h4>5.2 生产者-消费者问题</h4>

<p>问题描述：指存在数据供给与需求的两类进程。实现生产者-消费者问题的数据结构设计如下：</p>

<ol>
<li>含有n个缓冲区的公用缓冲池；</li>
<li>互斥信号量mutex：实现诸进程对缓冲池的互斥使用，一次仅允许一个进程读或写公用缓冲池，初值为1；</li>
<li>资源信号量empty：记录空缓冲区的个数，初值为n；</li>
<li>资源信号量full：记录满缓冲区的个数，初值为0.</li>
</ol>

<p>算法描述如下</p>

<pre><code>item B[k];
semaphore empty;
empty = k;    // 可以使用的空缓冲区数目
semaphore full;
full = 0;    // 缓冲区内可以使用的产品数
semaphore mutex;
mutex = 1;    // 互斥信号量
int in = 0;    // 写缓冲区指针
int out = 0;    // 读缓冲区指针

cobegin
process producer_i () {    // 生产者进程
    while (true) {
        produce();    // 先生产
        P(empty);    // 由于生产了一个，那么可用缓冲区数目减一，对应P操作
        P(mutex);    // 对临界区的操作必须互斥，执行mutex的P操作
        append to B[in];
        in = (in + 1) % k;
        V(mutex);    // 执行mutex的V操作
        V(full);    // 生产完毕，可使用产品数加一，对应V操作
    }
}

process producer_i () {    // 消费者进程
    while (true) {
        P(full);    // 因为是消费，所以可用产品数减一，对应full的P操作
        P(mutex);    // 临界区互斥操作，执行mutex的P操作
        take() from B[out];
        out = (out + 1) % k;
        V(mutex);    // 执行mutex的V操作
        V(empty);    // 因为消费了，所以空缓冲区数目加一，对应empty的V操作
        consume();    // 消费
    }
}
coend
</code></pre>

<p>可见，每个进程中对互斥信号量mutex的操作是成对出现的，而对于一般信号量的操作是进程间成对出现的，代表资源的获取与释放（特指在生产者-消费者中）。</p>

<h4>5.3 读者-写者问题</h4>

<p>问题描述：若干读者（Reader）进程和写者（Writer）进程共享一个数据文件，允许多个Reader进程同时读一个共享对象，但不允许一个Writer进程与其他Reader进程或者Writer进程同时访问共享对象。也就是说：</p>

<ol>
<li>允许多个读者同时进行操作；</li>
<li>只允许一个写者执行写操作；</li>
<li>任一写者在完成写操作之前不允许其他读者或者写者访问共享文件；</li>
<li>写者执行写操作前，应让已有的写者和读者全部退出。</li>
</ol>

<p>算法分析如下：</p>
</article>
                <section class="author" style="font-family:NSimSun">
                    <div class="avatar" style="background-image: url(https://cdn.nlark.com/yuque/0/2019/png/257195/1562157551682-avatar/dce920e8-dc39-4157-9c42-99d23f827fc4.png?x-oss-process=image/resize,m_fill,w_192,h_192/format,png);"></div>
                    <a class="name" href="/about.me.html">林奕清</a>
                    <div class="intro" style="font-family:KaiTi">两颗星亮不同的光辉，转陌生星轨</div>
                </section>
                <section class="recommend" style="font-family:KaiTi">
                    
                    
                    <section class="nav next">
                        <div class="head">下篇文章</div>
                        <a class="link" href="/configuration-of-beans-in-spring.html">Spring中Bean的配置方式</a>
                    </section>
                    
                </section>
                
            </article>
        </article>
        <footer class="footer" style="font-family:NSimSun">
    <span class="copyright">
        Feily Zhang ©
        <script type="text/javascript">
            document.write(new Date().getFullYear());
        </script>
    </span>
    <span class="publish">Powered by <a href="http://www.chole.io/" target="_blank">Ink</a></span>
</footer>

        <script src="/bundle/index.js"></script>
    </body>
</html>
